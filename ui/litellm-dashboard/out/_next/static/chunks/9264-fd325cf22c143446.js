"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9264],{91027:function(e,l,t){t.d(l,{Z:function(){return c}});var a=t(57437),s=t(33866),n=t(2265),r=t(9245);function i(e){let l=l=>{"disableShowNewBadge"===l.key&&e()},t=l=>{let{key:t}=l.detail;"disableShowNewBadge"===t&&e()};return window.addEventListener("storage",l),window.addEventListener(r.Qg,t),()=>{window.removeEventListener("storage",l),window.removeEventListener(r.Qg,t)}}function o(){return"true"===(0,r.le)("disableShowNewBadge")}function c(e){let{children:l}=e;return(0,n.useSyncExternalStore)(i,o)?l?(0,a.jsx)(a.Fragment,{children:l}):null:l?(0,a.jsx)(s.Z,{color:"blue",count:"New",children:l}):(0,a.jsx)(s.Z,{color:"blue",count:"New"})}},89264:function(e,l,t){t.d(l,{Z:function(){return eW}});var a=t(57437),s=t(78489),n=t(12514),r=t(67101),i=t(57365),o=t(59341),c=t(12485),d=t(18135),u=t(35242),m=t(29706),h=t(77991),g=t(21626),x=t(97214),f=t(28241),y=t(58834),p=t(69552),j=t(71876),v=t(84264),b=t(49566),Z=t(2265),C=t(57840),k=t(4260),w=t(37592),_=t(10032),N=t(22116),S=t(5545),E=t(9114),P=t(19250),T=t(23496),F=t(10353),A=t(61994);let{Title:I}=C.default;var z=e=>{let{accessToken:l}=e,[t,r]=(0,Z.useState)(!0),[i,o]=(0,Z.useState)([]);(0,Z.useEffect)(()=>{c()},[l]);let c=async()=>{if(l){r(!0);try{let e=await (0,P.getEmailEventSettings)(l);o(e.settings)}catch(e){console.error("Failed to fetch email event settings:",e),E.Z.fromBackend(e)}finally{r(!1)}}},d=(e,l)=>{o(i.map(t=>t.event===e?{...t,enabled:l}:t))},u=async()=>{if(l)try{await (0,P.updateEmailEventSettings)(l,{settings:i}),E.Z.success("Email event settings updated successfully")}catch(e){console.error("Failed to update email event settings:",e),E.Z.fromBackend(e)}},m=async()=>{if(l)try{await (0,P.resetEmailEventSettings)(l),E.Z.success("Email event settings reset to defaults"),c()}catch(e){console.error("Failed to reset email event settings:",e),E.Z.fromBackend(e)}},h=e=>{if(e.includes("Virtual Key Created"))return"An email will be sent to the user when a new virtual key is created with their user ID";if(e.includes("New User Invitation"))return"An email will be sent to the email address of the user when a new user is created";{let l=e.split(/(?=[A-Z])/).join(" ").toLowerCase();return"Receive an email notification when ".concat(l)}};return(0,a.jsxs)(n.Z,{children:[(0,a.jsx)(I,{level:4,children:"Email Notifications"}),(0,a.jsx)(v.Z,{children:"Select which events should trigger email notifications."}),(0,a.jsx)(T.Z,{}),t?(0,a.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:(0,a.jsx)(F.Z,{size:"large"})}):(0,a.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(A.Z,{checked:e.enabled,onChange:l=>d(e.event,l.target.checked)}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)(v.Z,{children:e.event}),(0,a.jsx)("div",{className:"text-sm text-gray-500 block",children:h(e.event)})]})]},e.event))}),(0,a.jsxs)("div",{className:"mt-6 flex space-x-4",children:[(0,a.jsx)(s.Z,{onClick:u,disabled:t,children:"Save Changes"}),(0,a.jsx)(s.Z,{onClick:m,variant:"secondary",disabled:t,children:"Reset to Defaults"})]})]})};let{Title:L}=C.default;var O=e=>{let{accessToken:l,premiumUser:t,alerts:i}=e,o=async()=>{if(!l)return;let e={};i.filter(e=>"email"===e.name).forEach(l=>{var t;Object.entries(null!==(t=l.variables)&&void 0!==t?t:{}).forEach(l=>{let[t,a]=l,s=document.querySelector('input[name="'.concat(t,'"]'));s&&s.value&&(e[t]=null==s?void 0:s.value)})}),console.log("updatedVariables",e);try{await (0,P.setCallbacksCall)(l,{general_settings:{alerting:["email"]},environment_variables:e}),E.Z.success("Email settings updated successfully")}catch(e){E.Z.fromBackend(e)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mt-6 mb-6",children:(0,a.jsx)(z,{accessToken:l})}),(0,a.jsxs)(n.Z,{children:[(0,a.jsx)(L,{level:4,children:"Email Server Settings"}),(0,a.jsxs)(v.Z,{children:[(0,a.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/email",target:"_blank",style:{color:"blue"},children:[" ","LiteLLM Docs: email alerts"]})," ",(0,a.jsx)("br",{})]}),(0,a.jsx)("div",{className:"flex w-full",children:i.filter(e=>"email"===e.name).map((e,l)=>{var s;return(0,a.jsx)(f.Z,{children:(0,a.jsx)("ul",{children:(0,a.jsx)(r.Z,{numItems:2,children:Object.entries(null!==(s=e.variables)&&void 0!==s?s:{}).map(e=>{let[l,s]=e;return(0,a.jsxs)("li",{className:"mx-2 my-2",children:[!0!=t&&("EMAIL_LOGO_URL"===l||"EMAIL_SUPPORT_CONTACT"===l)?(0,a.jsxs)("div",{children:[(0,a.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:(0,a.jsxs)(v.Z,{className:"mt-2",children:[" ✨ ",l]})}),(0,a.jsx)(b.Z,{name:l,defaultValue:s,type:"password",disabled:!0,style:{width:"400px"}})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)(v.Z,{className:"mt-2",children:l}),(0,a.jsx)(b.Z,{name:l,defaultValue:s,type:"password",style:{width:"400px"}})]}),(0,a.jsxs)("p",{style:{fontSize:"small",fontStyle:"italic"},children:["SMTP_HOST"===l&&(0,a.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP host address, e.g. `smtp.resend.com`",(0,a.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PORT"===l&&(0,a.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP port number, e.g. `587`",(0,a.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_USERNAME"===l&&(0,a.jsxs)("div",{style:{color:"gray"},children:["Enter the SMTP username, e.g. `username`",(0,a.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"SMTP_PASSWORD"===l&&(0,a.jsx)("span",{style:{color:"red"},children:" Required * "}),"SMTP_SENDER_EMAIL"===l&&(0,a.jsxs)("div",{style:{color:"gray"},children:["Enter the sender email address, e.g. `sender@berri.ai`",(0,a.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"TEST_EMAIL_ADDRESS"===l&&(0,a.jsxs)("div",{style:{color:"gray"},children:["Email Address to send `Test Email Alert` to. example: `info@berri.ai`",(0,a.jsx)("span",{style:{color:"red"},children:" Required * "})]}),"EMAIL_LOGO_URL"===l&&(0,a.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the Logo that appears in the email, pass a url to your logo"}),"EMAIL_SUPPORT_CONTACT"===l&&(0,a.jsx)("div",{style:{color:"gray"},children:"(Optional) Customize the support email address that appears in the email. Default is support@berri.ai"})]})]},l)})})})},l)})}),(0,a.jsx)(s.Z,{className:"mt-2",onClick:()=>o(),children:"Save Changes"}),(0,a.jsx)(s.Z,{onClick:async()=>{if(l)try{await (0,P.serviceHealthCheck)(l,"email"),E.Z.success("Email test triggered. Check your configured email inbox/logs.")}catch(e){E.Z.fromBackend(e)}},className:"mx-2",children:"Test Email Alerts"})]})]})},D=t(2740),U=t(19015),R=t(44643),B=t(74998),q=t(41649),M=t(47323),W=e=>{let{alertingSettings:l,handleInputChange:t,handleResetField:n,handleSubmit:r,premiumUser:i}=e,[c]=_.Z.useForm();return(0,a.jsxs)(_.Z,{form:c,onFinish:()=>{console.log("INSIDE ONFINISH");let e=c.getFieldsValue(),l=Object.entries(e).every(e=>{let[l,t]=e;return"boolean"!=typeof t&&(""===t||null==t)});console.log("formData: ".concat(JSON.stringify(e),", isEmpty: ").concat(l)),l?console.log("Some form fields are empty."):r(e)},labelAlign:"left",children:[l.map((e,l)=>(0,a.jsxs)(j.Z,{children:[(0,a.jsxs)(f.Z,{align:"center",children:[(0,a.jsx)(v.Z,{children:e.field_name}),(0,a.jsx)("p",{style:{fontSize:"0.65rem",color:"#808080",fontStyle:"italic"},className:"mt-1",children:e.field_description})]}),e.premium_field?i?(0,a.jsx)(_.Z.Item,{name:e.field_name,children:(0,a.jsx)(f.Z,{children:"Integer"===e.field_type?(0,a.jsx)(U.Z,{step:1,value:e.field_value,onChange:l=>t(e.field_name,l)}):"Boolean"===e.field_type?(0,a.jsx)(o.Z,{checked:e.field_value,onChange:l=>t(e.field_name,l)}):(0,a.jsx)(k.default,{value:e.field_value,onChange:l=>t(e.field_name,l)})})}):(0,a.jsx)(f.Z,{children:(0,a.jsx)(s.Z,{className:"flex items-center justify-center",children:(0,a.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})})}):(0,a.jsx)(_.Z.Item,{name:e.field_name,className:"mb-0",valuePropName:"Boolean"===e.field_type?"checked":"value",children:(0,a.jsx)(f.Z,{children:"Integer"===e.field_type?(0,a.jsx)(U.Z,{step:1,value:e.field_value,onChange:l=>t(e.field_name,l),className:"p-0"}):"Boolean"===e.field_type?(0,a.jsx)(o.Z,{checked:e.field_value,onChange:l=>{t(e.field_name,l),c.setFieldsValue({[e.field_name]:l})}}):(0,a.jsx)(k.default,{value:e.field_value,onChange:l=>t(e.field_name,l)})})}),(0,a.jsx)(f.Z,{children:!0==e.stored_in_db?(0,a.jsx)(q.Z,{icon:R.Z,className:"text-white",children:"In DB"}):!1==e.stored_in_db?(0,a.jsx)(q.Z,{className:"text-gray bg-white outline",children:"In Config"}):(0,a.jsx)(q.Z,{className:"text-gray bg-white outline",children:"Not Set"})}),(0,a.jsx)(f.Z,{children:(0,a.jsx)(M.Z,{icon:B.Z,color:"red",onClick:()=>n(e.field_name,l),children:"Reset"})})]},l)),(0,a.jsx)("div",{children:(0,a.jsx)(S.ZP,{htmlType:"submit",children:"Update Settings"})})]})},H=e=>{let{accessToken:l,premiumUser:t}=e,[s,n]=(0,Z.useState)([]);return(0,Z.useEffect)(()=>{l&&(0,P.alertingSettingsCall)(l).then(e=>{n(e)})},[l]),(0,a.jsx)(W,{alertingSettings:s,handleInputChange:(e,l)=>{let t=s.map(t=>t.field_name===e?{...t,field_value:l}:t);console.log("updatedSettings: ".concat(JSON.stringify(t))),n(t)},handleResetField:(e,t)=>{if(l)try{let l=s.map(l=>l.field_name===e?{...l,stored_in_db:null,field_value:l.field_default_value}:l);n(l)}catch(e){console.log("ERROR OCCURRED!")}},handleSubmit:e=>{if(!l||(console.log("formValues: ".concat(e)),null==e||void 0==e))return;let t={};s.forEach(e=>{t[e.field_name]=e.field_value});let a={...e,...t};console.log("mergedFormValues: ".concat(JSON.stringify(a)));let{slack_alerting:n,...r}=a;console.log("slack_alerting: ".concat(n,", alertingArgs: ").concat(JSON.stringify(r)));try{(0,P.updateConfigFieldSetting)(l,"alerting_args",r),"boolean"==typeof n&&(!0==n?(0,P.updateConfigFieldSetting)(l,"alerting",["slack"]):(0,P.updateConfigFieldSetting)(l,"alerting",[])),E.Z.success("Wait 10s for proxy to update.")}catch(e){}},premiumUser:t})},J=t(16312),K=t(56609),V=t(6833),G=t(39957);let Q=[{value:"success",label:"Success"},{value:"failure",label:"Failure"},{value:"success_and_failure",label:"Success & Failure"}],X=e=>{let{callbacks:l,availableCallbacks:t={},onTest:s=()=>{},onEdit:n=()=>{},onDelete:r=()=>{},onAdd:i=()=>{}}=e,o=[{title:(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Callback Name"}),dataIndex:"name",key:"name",render:(e,l)=>{var s;let n=l.name;console.log("availableCallbacks",t);let r=(null===(s=t[n])||void 0===s?void 0:s.ui_callback_name)||n;return(0,a.jsx)("div",{className:"font-medium text-gray-800",children:r})}},{title:(0,a.jsx)("span",{className:"font-medium text-gray-700",children:"Mode"}),key:"mode",render:(e,l)=>{var t;let s=l.mode||"success",n=(null===(t=Q.find(e=>e.value===s))||void 0===t?void 0:t.label)||s,r="success"===s?"bg-green-100 text-green-800":"failure"===s?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800";return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(r),children:n})},width:240},{title:(0,a.jsx)("span",{className:"font-medium text-gray-700 text-right w-full block",children:"Actions"}),key:"actions",align:"right",render:(e,l)=>(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(G.Z,{variant:"Test",tooltipText:"Test Callback",onClick:()=>s(l)}),(0,a.jsx)(G.Z,{variant:"Edit",tooltipText:"Edit Callback",onClick:()=>n(l)}),(0,a.jsx)(G.Z,{variant:"Delete",tooltipText:"Delete Callback",onClick:()=>r(l)})]}),width:240}];return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"w-full mt-4",children:[(0,a.jsx)(J.z,{onClick:i,className:"mx-auto",children:"+ Add Callback"}),(0,a.jsx)("div",{className:"flex justify-between items-center my-2",children:(0,a.jsx)(V.Z,{level:4,children:"Active Logging Callbacks"})}),0===l.length?(0,a.jsx)("div",{className:"flex flex-col items-center justify-center p-8 bg-gray-50 border border-gray-200 rounded-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No callbacks configured"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Add your first callback to start logging data to external services."})]})}):(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,a.jsx)(K.Z,{columns:o,dataSource:l,rowKey:e=>e.name,pagination:!1,rowClassName:()=>"hover:bg-gray-50"})})]})})};var Y=t(85968),$=t(21609),ee=t(11713),el=t(29827),et=t(21770),ea=t(90246);let es=(0,ea.n)("cloudZeroSettings"),en=async e=>{let l=(0,P.getProxyBaseUrl)(),t=await fetch(l?"".concat(l,"/cloudzero/settings"):"/cloudzero/settings",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e="Failed to fetch CloudZero settings";try{let l=await t.json();if("object"==typeof l&&null!==l){var a;e=(null==l?void 0:null===(a=l.error)||void 0===a?void 0:a.message)||(null==l?void 0:l.error)||(null==l?void 0:l.message)||(null==l?void 0:l.detail)||("string"==typeof(null==l?void 0:l.error)?l.error:e)}else"string"==typeof l&&(e=l)}catch(l){e=t.statusText||e}throw Error(e)}let s=await t.json();return s&&(s.api_key_masked||s.connection_id)?s:null},er=e=>(0,ee.a)({queryKey:es.list({}),queryFn:async()=>await en(e),enabled:!!e&&!!(0,P.getProxyBaseUrl)(),staleTime:36e5,gcTime:36e5}),ei=async(e,l)=>{let t=(0,P.getProxyBaseUrl)(),a=await fetch(t?"".concat(t,"/cloudzero/settings"):"/cloudzero/settings",{method:"PUT",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({...l.connection_id&&{connection_id:l.connection_id},...l.timezone&&{timezone:l.timezone},...l.api_key&&{api_key:l.api_key}})});if(!a.ok){let e="Failed to update CloudZero settings";try{let l=await a.json();if("object"==typeof l&&null!==l){var s;e=(null==l?void 0:null===(s=l.error)||void 0===s?void 0:s.message)||(null==l?void 0:l.error)||(null==l?void 0:l.message)||(null==l?void 0:l.detail)||("string"==typeof(null==l?void 0:l.error)?l.error:e)}else"string"==typeof l&&(e=l)}catch(l){e=a.statusText||e}throw Error(e)}return await a.json()},eo=e=>{let l=(0,el.NL)();return(0,et.D)({mutationFn:async l=>{if(!e)throw Error("Access token is required");return await ei(e,l)},onSuccess:()=>{l.invalidateQueries({queryKey:es.list({})})}})},ec=async e=>{let l=(0,P.getProxyBaseUrl)(),t=await fetch(l?"".concat(l,"/cloudzero/delete"):"/cloudzero/delete",{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){let e="Failed to delete CloudZero settings";try{let l=await t.json();if("object"==typeof l&&null!==l){var a;e=(null==l?void 0:null===(a=l.error)||void 0===a?void 0:a.message)||(null==l?void 0:l.error)||(null==l?void 0:l.message)||(null==l?void 0:l.detail)||("string"==typeof(null==l?void 0:l.error)?l.error:e)}else"string"==typeof l&&(e=l)}catch(l){e=t.statusText||e}throw Error(e)}return await t.json()},ed=e=>{let l=(0,el.NL)();return(0,et.D)({mutationFn:async()=>{if(!e)throw Error("Access token is required");return await ec(e)},onSuccess:()=>{l.invalidateQueries({queryKey:es.list({})})}})};var eu=t(80443),em=t(5945),eh=t(85180);let{Title:eg,Paragraph:ex}=C.default;function ef(e){let{startCreation:l}=e;return(0,a.jsx)("div",{className:"bg-white p-12 rounded-lg border border-dashed border-gray-300 text-center max-w-2xl mx-auto mt-8",children:(0,a.jsx)(eh.Z,{image:eh.Z.PRESENTED_IMAGE_SIMPLE,description:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eg,{level:4,children:"No CloudZero Integration Found"}),(0,a.jsx)(ex,{type:"secondary",className:"max-w-md mx-auto",children:"Connect your CloudZero account to start tracking and analyzing your cloud costs directly from LiteLLM."})]}),children:(0,a.jsx)(S.ZP,{type:"primary",size:"large",onClick:l,className:"flex items-center gap-2 mx-auto mt-4",children:"Add CloudZero Integration"})})})}var ey=t(42264);let ep=async(e,l)=>{var t,a;let s=(0,P.getProxyBaseUrl)(),n=await fetch(s?"".concat(s,"/cloudzero/init"):"/cloudzero/init",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({connection_id:l.connection_id,timezone:null!==(t=l.timezone)&&void 0!==t?t:"UTC",...l.api_key&&{api_key:l.api_key}})});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((null==e?void 0:null===(a=e.error)||void 0===a?void 0:a.message)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Failed to create CloudZero integration")}return await n.json()},ej=e=>(0,et.D)({mutationFn:async l=>{if(!e)throw Error("Access token is required");return await ep(e,l)}});function ev(e){let{open:l,onOk:t,onCancel:s}=e,{accessToken:n}=(0,eu.Z)(),[r]=_.Z.useForm(),i=ej(n||"");(0,Z.useEffect)(()=>{l&&r.resetFields()},[l,r]);let o=async()=>{try{let e=await r.validateFields();i.mutate({connection_id:e.connection_id,timezone:e.timezone||"UTC",...e.api_key&&{api_key:e.api_key}},{onSuccess:()=>{ey.ZP.success("CloudZero integration created successfully"),r.resetFields(),t()},onError:e=>{null!=e&&e.errorFields||ey.ZP.error((null==e?void 0:e.message)||"Failed to create CloudZero integration")}})}catch(e){if(null==e?void 0:e.errorFields)return;ey.ZP.error((null==e?void 0:e.message)||"Failed to create CloudZero integration")}};return(0,a.jsx)(N.Z,{title:"Create CloudZero Integration",open:l,onOk:o,onCancel:()=>{r.resetFields(),s()},confirmLoading:i.isPending,okText:i.isPending?"Creating...":"Create",cancelText:"Cancel",okButtonProps:{disabled:i.isPending},cancelButtonProps:{disabled:i.isPending},children:(0,a.jsxs)(_.Z,{form:r,layout:"vertical",onFinish:o,children:[(0,a.jsx)(_.Z.Item,{label:"CloudZero API Key",name:"api_key",rules:[{required:!0,message:"Please enter your CloudZero API key"}],children:(0,a.jsx)(k.default.Password,{placeholder:"Enter your CloudZero API key"})}),(0,a.jsx)(_.Z.Item,{label:"Connection ID",name:"connection_id",rules:[{required:!0,message:"Please enter your CloudZero connection ID"}],children:(0,a.jsx)(k.default,{placeholder:"Enter your CloudZero connection ID"})}),(0,a.jsx)(_.Z.Item,{label:"Timezone",name:"timezone",tooltip:"Timezone for date handling (defaults to UTC if not provided)",children:(0,a.jsx)(k.default,{placeholder:"UTC"})})]})})}let eb=async function(e){var l,t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,P.getProxyBaseUrl)(),n=await fetch(s?"".concat(s,"/cloudzero/dry-run"):"/cloudzero/dry-run",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({limit:null!==(l=a.limit)&&void 0!==l?l:10})});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Failed to perform dry run")}return await n.json()},eZ=e=>(0,et.D)({mutationFn:async function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)throw Error("Access token is required");return await eb(e,l)}}),eC=async function(e){var l,t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,P.getProxyBaseUrl)(),n=await fetch(s?"".concat(s,"/cloudzero/export"):"/cloudzero/export",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({operation:null!==(l=a.operation)&&void 0!==l?l:"replace_hourly"})});if(!n.ok){let e=await n.json().catch(()=>({}));throw Error((null==e?void 0:null===(t=e.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||"Failed to export data")}return await n.json()},ek=e=>(0,et.D)({mutationFn:async function(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)throw Error("Access token is required");return await eC(e,l)}});var ew=t(3810),e_=t(76188),eN=t(867),eS=t(51653),eE=t(15868),eP=t(18930),eT=t(33276),eF=t(17689),eA=t(41671);function eI(e){let{open:l,onOk:t,onCancel:s,settings:n}=e,{accessToken:r}=(0,eu.Z)(),[i]=_.Z.useForm(),o=eo(r||"");(0,Z.useEffect)(()=>{l&&n?i.setFieldsValue({connection_id:n.connection_id,timezone:n.timezone||"UTC",api_key:""}):l&&i.resetFields()},[l,n,i]);let c=async()=>{try{let e=await i.validateFields();o.mutate({connection_id:e.connection_id,timezone:e.timezone||"UTC",...e.api_key&&{api_key:e.api_key}},{onSuccess:()=>{ey.ZP.success("CloudZero integration updated successfully"),i.resetFields(),t()},onError:e=>{null!=e&&e.errorFields||ey.ZP.error((null==e?void 0:e.message)||"Failed to update CloudZero integration")}})}catch(e){if(null==e?void 0:e.errorFields)return;ey.ZP.error((null==e?void 0:e.message)||"Failed to update CloudZero integration")}};return(0,a.jsx)(N.Z,{title:"Edit CloudZero Integration",open:l,onOk:c,onCancel:()=>{i.resetFields(),s()},confirmLoading:o.isPending,okText:o.isPending?"Updating...":"Update",cancelText:"Cancel",okButtonProps:{disabled:o.isPending},cancelButtonProps:{disabled:o.isPending},children:(0,a.jsxs)(_.Z,{form:i,layout:"vertical",onFinish:c,children:[(0,a.jsx)(_.Z.Item,{label:"CloudZero API Key",name:"api_key",rules:[{required:!1,message:"Please enter your CloudZero API key"}],tooltip:"Leave empty to keep the existing API key",children:(0,a.jsx)(k.default.Password,{placeholder:"Leave empty to keep existing"})}),(0,a.jsx)(_.Z.Item,{label:"Connection ID",name:"connection_id",rules:[{required:!0,message:"Please enter your CloudZero connection ID"}],children:(0,a.jsx)(k.default,{placeholder:"Enter your CloudZero connection ID"})}),(0,a.jsx)(_.Z.Item,{label:"Timezone",name:"timezone",tooltip:"Timezone for date handling (defaults to UTC if not provided)",children:(0,a.jsx)(k.default,{placeholder:"UTC"})})]})})}function ez(e){let{settings:l,onSettingsUpdated:t}=e,{accessToken:s}=(0,eu.Z)(),[n,r]=(0,Z.useState)(!1),[i,o]=(0,Z.useState)(!1),c=eZ(s||""),d=ek(s||""),u=ed(s||""),m=c.data?JSON.stringify(c.data,null,2):null,h=async()=>{r(!1),t()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"space-y-6 w-full max-w-4xl mx-auto",children:(0,a.jsxs)(em.Z,{title:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg font-semibold",children:"CloudZero Configuration"}),(0,a.jsx)(ew.Z,{color:"success",className:"ml-2 capitalize",children:l.status||"Active"})]}),extra:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(S.ZP,{icon:(0,a.jsx)(eE.Z,{size:16}),onClick:()=>{r(!0)},className:"flex items-center gap-2",children:"Edit"}),(0,a.jsx)(S.ZP,{danger:!0,icon:(0,a.jsx)(eP.Z,{size:16}),onClick:()=>{o(!0)},className:"flex items-center gap-2",children:"Delete"})]}),className:"shadow-sm",children:[(0,a.jsxs)(e_.Z,{bordered:!0,column:{xxl:1,xl:1,lg:1,md:1,sm:1,xs:1},children:[(0,a.jsx)(e_.Z.Item,{label:"API Key (Redacted)",children:(0,a.jsx)("span",{className:"font-mono text-gray-600",children:l.api_key_masked||(0,a.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"})})}),(0,a.jsx)(e_.Z.Item,{label:"Connection ID",children:(0,a.jsx)("span",{className:"font-mono text-gray-600",children:l.connection_id||(0,a.jsx)("span",{className:"text-gray-400 italic",children:"Not configured"})})}),(0,a.jsx)(e_.Z.Item,{label:"Timezone",children:l.timezone||(0,a.jsx)("span",{className:"text-gray-400 italic",children:"Default (UTC)"})})]}),(0,a.jsx)(T.Z,{orientation:"left",className:"text-gray-500",children:"Actions"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 mb-6",children:[(0,a.jsx)(S.ZP,{onClick:()=>{s&&c.mutate({limit:10},{onSuccess:e=>{ey.ZP.success("Dry run completed successfully")},onError:e=>{ey.ZP.error((null==e?void 0:e.message)||"Failed to perform dry run")}})},loading:c.isPending,icon:(0,a.jsx)(eT.Z,{size:16}),className:"flex items-center gap-2",children:"Run Dry Run Simulation"}),(0,a.jsx)(eN.Z,{title:"Export Data to CloudZero",description:"This will push the current accumulated cost data to CloudZero. Continue?",onConfirm:()=>{s&&d.mutate({operation:"replace_hourly"},{onSuccess:()=>{ey.ZP.success("Data successfully exported to CloudZero")},onError:e=>{ey.ZP.error((null==e?void 0:e.message)||"Failed to export data")}})},okText:"Export",cancelText:"Cancel",children:(0,a.jsx)(S.ZP,{type:"primary",loading:d.isPending,icon:(0,a.jsx)(eF.Z,{size:16}),className:"flex items-center gap-2",children:"Export Data Now"})})]}),m&&(0,a.jsx)("div",{className:"mt-6 animate-in fade-in slide-in-from-top-4 duration-300",children:(0,a.jsx)(eS.Z,{message:"Dry Run Results",description:(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("p",{className:"mb-2 text-gray-600",children:["Simulation output for connection: ",l.connection_id]}),(0,a.jsx)("pre",{className:"bg-gray-50 p-4 rounded-md border border-gray-200 overflow-x-auto text-xs font-mono text-gray-800",children:m})]}),type:"info",showIcon:!0,icon:(0,a.jsx)(eA.Z,{className:"text-blue-500"})})})]})}),(0,a.jsx)(eI,{open:n,onOk:h,onCancel:()=>{r(!1)},settings:l}),(0,a.jsx)($.Z,{isOpen:i,title:"Delete CloudZero Integration?",message:"Are you sure you want to delete this CloudZero integration? All associated settings and configurations will be permanently removed.",resourceInformationTitle:"Integration Details",resourceInformation:[{label:"Connection ID",value:l.connection_id,code:!0},{label:"Timezone",value:l.timezone||"Default (UTC)"}],onCancel:()=>{o(!1)},onOk:()=>{s&&u.mutate(void 0,{onSuccess:()=>{ey.ZP.success("CloudZero integration deleted successfully"),o(!1),t()},onError:e=>{ey.ZP.error((null==e?void 0:e.message)||"Failed to delete CloudZero integration")}})},confirmLoading:u.isPending})]})}function eL(){let{accessToken:e}=(0,eu.Z)(),{data:l,isLoading:t,error:s}=er(e),n=(0,el.NL)(),r=(0,ea.n)("cloudZeroSettings"),[i,o]=(0,Z.useState)(!1),c=async()=>{o(!1),await n.invalidateQueries({queryKey:r.list({})})};return t?(0,a.jsx)(em.Z,{children:(0,a.jsx)(C.default.Text,{children:"Loading CloudZero settings..."})}):s?(0,a.jsx)(em.Z,{children:(0,a.jsxs)(C.default.Text,{className:"text-red-600",children:["Error loading CloudZero settings: ",s instanceof Error?s.message:String(s)]})}):l?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(ez,{settings:l,onSettingsUpdated:c})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ef,{startCreation:()=>o(!0)}),(0,a.jsx)(ev,{open:i,onOk:c,onCancel:()=>{o(!1)}})]})}var eO=t(91027);let{Title:eD,Paragraph:eU}=C.default,eR=e=>{let{params:l,callbackConfigs:t,selectedCallback:s}=e;return l&&0!==l.length?(0,a.jsx)("div",{className:"space-y-4 mt-6 p-4 bg-gray-50 rounded-lg border",children:l.map(e=>{var l;let n=t.find(e=>e.id===s),r=(null==n?void 0:null===(l=n.dynamic_params)||void 0===l?void 0:l[e])||{},i=r.type||"text",o=r.ui_name||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),c=r.required||!1;return(0,a.jsx)(D.Z,{label:(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[o," "]}),name:e,className:"mb-4",rules:c?[{required:!0,message:"Please enter the ".concat(o.toLowerCase())}]:void 0,children:"password"===i?(0,a.jsx)(k.default.Password,{size:"large",placeholder:"Enter your ".concat(o.toLowerCase()),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"}):"number"===i?(0,a.jsx)(k.default,{type:"number",size:"large",placeholder:"Enter ".concat(o.toLowerCase()),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:0,max:1,step:.1}):(0,a.jsx)(k.default,{size:"large",placeholder:"Enter your ".concat(o.toLowerCase()),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})},e)})}):null},eB=e=>{let{callbackConfigs:l,selectedCallback:t,onCallbackChange:s,disabled:n=!1}=e;return(0,a.jsx)(D.Z,{label:"Callback",name:"callback",rules:n?void 0:[{required:!0,message:"Please select a callback"}],children:(0,a.jsx)(w.default,{placeholder:"Choose a logging callback...",size:"large",className:"w-full",showSearch:!0,disabled:n,value:t,filterOption:(e,l)=>{var t,a;return(null!==(a=null==l?void 0:null===(t=l.value)||void 0===t?void 0:t.toString())&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},onChange:s,children:l.map(e=>{let l=e.logo,t=l&&(l.includes("/")||l.startsWith("data:")||l.startsWith("http"))?l:"".concat("../ui/assets/logos/").concat(l);return(0,a.jsx)(i.Z,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center space-x-3 py-1",children:[(0,a.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,a.jsx)("img",{src:t,alt:"".concat(e.displayName," logo"),className:"w-6 h-6 rounded object-contain",onError:e=>{e.currentTarget.style.display="none"}})}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.displayName})]})},e.id)})})})},eq=(e,l,t)=>{if(!e)return t?Object.keys(t):[];let a=l.find(l=>l.id===e);return(null==a?void 0:a.dynamic_params)?Object.keys(a.dynamic_params):t?Object.keys(t):[]},eM=(e,l)=>({environment_variables:e,litellm_settings:{success_callback:[l]}});var eW=e=>{let{accessToken:l,userRole:t,userID:i,premiumUser:C}=e,[k,w]=(0,Z.useState)([]),[T,F]=(0,Z.useState)([]),[A,I]=(0,Z.useState)(!1),[z]=_.Z.useForm(),[L]=_.Z.useForm(),[D,U]=(0,Z.useState)(null),[R,B]=(0,Z.useState)(""),[q,M]=(0,Z.useState)({}),[W,J]=(0,Z.useState)([]),[K,V]=(0,Z.useState)(!1),[G,Q]=(0,Z.useState)([]),[ee,el]=(0,Z.useState)({}),[et,ea]=(0,Z.useState)([]),[es,en]=(0,Z.useState)(!1),[er,ei]=(0,Z.useState)(null),[eo,ec]=(0,Z.useState)(!1),[ed,eu]=(0,Z.useState)(null),[em,eh]=(0,Z.useState)(!1),[eg,ex]=(0,Z.useState)(!1),[ef,ey]=(0,Z.useState)(!1);(0,Z.useEffect)(()=>{l&&(0,P.getCallbackConfigsCall)(l).then(e=>{Q(e||[])}).catch(e=>{E.Z.fromBackend("Failed to load callback configs: "+(0,Y.O)(e))})},[l]),(0,Z.useEffect)(()=>{if(es&&er){let e=Object.fromEntries(Object.entries(er.variables||{}).map(e=>{let[l,t]=e;return[l,null!=t?t:""]}));L.setFieldsValue({...e,callback:er.name})}},[es,er,L]);let ep=e=>{W.includes(e)?J(W.filter(l=>l!==e)):J([...W,e])},ej={llm_exceptions:"LLM Exceptions",llm_too_slow:"LLM Responses Too Slow",llm_requests_hanging:"LLM Requests Hanging",budget_alerts:"Budget Alerts (API Keys, Users)",db_exceptions:"Database Exceptions (Read/Write)",daily_reports:"Weekly/Monthly Spend Reports",outage_alerts:"Outage Alerts",region_outage_alerts:"Region Outage Alerts"};(0,Z.useEffect)(()=>{l&&t&&i&&(0,P.getCallbacksCall)(l,i,t).then(e=>{w(e.callbacks),el(e.available_callbacks);let l=e.alerts;if(l&&l.length>0){let e=l[0],t=e.variables.SLACK_WEBHOOK_URL;J(e.active_alerts),B(t),M(e.alerts_to_webhook)}F(l)})},[l,t,i]);let ev=e=>W&&W.includes(e),eb=async(e,a,s)=>{if(!l)return;s?eh(!0):ex(!0);let n=eM(e,a);try{if(await (0,P.setCallbacksCall)(l,n),E.Z.success(s?"Callback updated successfully":"Callback ".concat(a," added successfully")),s?(en(!1),L.resetFields(),ei(null)):(V(!1),z.resetFields(),U(null),ea([])),i&&t){let e=await (0,P.getCallbacksCall)(l,i,t);w(e.callbacks)}}catch(e){E.Z.fromBackend(e)}finally{s?eh(!1):ex(!1)}},eZ=async e=>{er&&await eb(e,er.name,!0)},eC=async e=>{let l=null==e?void 0:e.callback;l&&await eb(e,l,!1)},ek=async()=>{if(!l)return;let e={};Object.entries(ej).forEach(l=>{let[t,a]=l,s=document.querySelector('input[name="'.concat(t,'"]')),n=(null==s?void 0:s.value)||"";e[t]=n});try{await (0,P.setCallbacksCall)(l,{general_settings:{alert_to_webhook_url:e,alert_types:W}})}catch(e){E.Z.fromBackend(e)}E.Z.success("Alerts updated successfully")},ew=e=>{eu(e),ec(!0)},e_=async()=>{if(ed&&l)try{if(ey(!0),await (0,P.deleteCallback)(l,ed.name),E.Z.success("Callback ".concat(ed.name," deleted successfully")),i&&t){let e=await (0,P.getCallbacksCall)(l,i,t);w(e.callbacks)}ec(!1),eu(null)}catch(e){console.error("Failed to delete callback:",e),E.Z.fromBackend(e)}finally{ey(!1)}};return l?(0,a.jsxs)("div",{className:"w-full mx-4",children:[(0,a.jsx)(r.Z,{numItems:1,className:"gap-2 p-8 w-full mt-2",children:(0,a.jsxs)(d.Z,{children:[(0,a.jsxs)(u.Z,{variant:"line",defaultValue:"1",children:[(0,a.jsx)(c.Z,{value:"1",children:"Logging Callbacks"}),(0,a.jsxs)(c.Z,{value:"2",children:["CloudZero Cost Tracking ",(0,a.jsx)(eO.Z,{})]}),(0,a.jsx)(c.Z,{value:"2",children:"Alerting Types"}),(0,a.jsx)(c.Z,{value:"3",children:"Alerting Settings"}),(0,a.jsx)(c.Z,{value:"4",children:"Email Alerts"})]}),(0,a.jsxs)(h.Z,{children:[(0,a.jsx)(m.Z,{children:(0,a.jsx)(X,{callbacks:k,availableCallbacks:ee,onAdd:()=>V(!0),onEdit:e=>{ei(e),en(!0)},onDelete:e=>ew(e),onTest:async e=>{try{await (0,P.serviceHealthCheck)(l,e.name),E.Z.success("Health check triggered")}catch(e){E.Z.fromBackend((0,Y.O)(e))}}})}),(0,a.jsx)(m.Z,{children:(0,a.jsx)("div",{className:"p-8",children:(0,a.jsx)(eL,{})})}),(0,a.jsx)(m.Z,{children:(0,a.jsxs)(n.Z,{children:[(0,a.jsxs)(v.Z,{className:"my-2",children:["Alerts are only supported for Slack Webhook URLs. Get your webhook urls from"," ",(0,a.jsx)("a",{href:"https://api.slack.com/messaging/webhooks",target:"_blank",style:{color:"blue"},children:"here"})]}),(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(y.Z,{children:(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(p.Z,{}),(0,a.jsx)(p.Z,{}),(0,a.jsx)(p.Z,{children:"Slack Webhook URL"})]})}),(0,a.jsx)(x.Z,{children:Object.entries(ej).map((e,l)=>{let[t,n]=e;return(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(f.Z,{children:"region_outage_alerts"==t?C?(0,a.jsx)(o.Z,{id:"switch",name:"switch",checked:ev(t),onChange:()=>ep(t)}):(0,a.jsx)(s.Z,{className:"flex items-center justify-center",children:(0,a.jsx)("a",{href:"https://forms.gle/W3U4PZpJGFHWtHyA9",target:"_blank",children:"✨ Enterprise Feature"})}):(0,a.jsx)(o.Z,{id:"switch",name:"switch",checked:ev(t),onChange:()=>ep(t)})}),(0,a.jsx)(f.Z,{children:(0,a.jsx)(v.Z,{children:n})}),(0,a.jsx)(f.Z,{children:(0,a.jsx)(b.Z,{name:t,type:"password",defaultValue:q&&q[t]?q[t]:R})})]},l)})})]}),(0,a.jsx)(s.Z,{size:"xs",className:"mt-2",onClick:ek,children:"Save Changes"}),(0,a.jsx)(s.Z,{onClick:async()=>{try{await (0,P.serviceHealthCheck)(l,"slack"),E.Z.success("Alert test triggered. Test request to slack made - check logs/alerts on slack to verify")}catch(e){E.Z.fromBackend((0,Y.O)(e))}},className:"mx-2",children:"Test Alerts"})]})}),(0,a.jsx)(m.Z,{children:(0,a.jsx)(H,{accessToken:l,premiumUser:C})}),(0,a.jsx)(m.Z,{children:(0,a.jsx)(O,{accessToken:l,premiumUser:C,alerts:T})})]})]})}),(0,a.jsxs)(N.Z,{title:"Add Logging Callback",open:K,width:800,onCancel:()=>{V(!1),U(null),ea([])},footer:null,children:[(0,a.jsxs)("a",{href:"https://docs.litellm.ai/docs/proxy/logging",className:"mb-8 mt-4",target:"_blank",style:{color:"blue"},children:[" ","LiteLLM Docs: Logging"]}),(0,a.jsxs)(_.Z,{form:z,onFinish:eC,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[(0,a.jsx)(eB,{callbackConfigs:G,selectedCallback:D,onCallbackChange:e=>{U(e),ea(eq(e,G))}}),(0,a.jsx)(eR,{params:et,callbackConfigs:G,selectedCallback:D}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 mt-6 border-t border-gray-200",children:[(0,a.jsx)(S.ZP,{onClick:()=>{V(!1),U(null),ea([]),z.resetFields()},disabled:eg,children:"Cancel"}),(0,a.jsx)(S.ZP,{htmlType:"submit",loading:eg,disabled:eg,children:eg?"Adding...":"Add Callback"})]})]})]}),(0,a.jsx)(N.Z,{open:es,width:800,title:"Edit Callback Settings",onCancel:()=>{en(!1),ei(null),L.resetFields()},footer:null,children:(0,a.jsxs)(_.Z,{form:L,onFinish:eZ,labelCol:{span:8},wrapperCol:{span:16},labelAlign:"left",children:[er&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eB,{callbackConfigs:G,selectedCallback:er.name,onCallbackChange:()=>{},disabled:!0}),(0,a.jsx)(eR,{params:eq(er.name,G,er.variables),callbackConfigs:G,selectedCallback:er.name})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 mt-6 border-t border-gray-200",children:[(0,a.jsx)(S.ZP,{onClick:()=>{en(!1),ei(null),L.resetFields()},disabled:em,children:"Cancel"}),(0,a.jsx)(S.ZP,{onClick:()=>{L.submit()},loading:em,disabled:em,children:em?"Saving...":"Save Changes"})]})]})}),(0,a.jsx)($.Z,{isOpen:eo,title:"Delete Callback",message:"Are you sure you want to delete this callback? This action cannot be undone.",resourceInformationTitle:"Callback Information",resourceInformation:[{label:"Callback Name",value:null==ed?void 0:ed.name},{label:"Mode",value:(null==ed?void 0:ed.mode)||"success"}],onCancel:()=>{ec(!1),eu(null)},onOk:e_,confirmLoading:ef})]}):null}}}]);